# Script Events – General Usage Guide

This document explains what Script Events are, how they work, and how to use them step by step in Minecraft Bedrock Edition using the Script API.

---

## 1. What Is a Script Event

A **Script Event** is a custom event that allows Minecraft commands, blocks, NPCs, or entities to send data directly to the Script API.

Script Events act as a **bridge between the command system and JavaScript logic**.

They are triggered using the `/scriptevent` command and handled inside a script.

---

## 2. Basic Structure of a Script Event

A Script Event is composed of:

```
/scriptevent <namespace:event> <message>
```

### Example

```
/scriptevent example:test Hello
```

* `example:test` → Event identifier
* `Hello` → Message payload (string)

---

## 3. Event Identifier (Namespace)

Script Event identifiers follow this format:

```
namespace:eventName
```

### Why namespaces matter

* Prevent name collisions
* Allow modular design
* Act like an API boundary

**Good examples**

```
admin:kick
economy:pay
ui:open
```

**Bad examples**

```
test
event1
command
```

---

## 4. Listening to Script Events in JavaScript

To handle Script Events, you subscribe to `scriptEventReceive`.

### Minimal Listener Example

```js
import { system } from "@minecraft/server";

system.afterEvents.scriptEventReceive.subscribe((event) => {
    console.log(event.id, event.message);
});
```

At this stage, the script receives **all** Script Events.

---

## 5. Filtering by Event ID

Always filter events by identifier.

```js
if (event.id !== "example:test") return;
```

This ensures your logic only reacts to the intended event.

---

## 6. Understanding the Event Object

When a Script Event is received, the script gets a `ScriptEventCommandMessageAfterEvent` object.

### Important Properties

| Property       | Description                |
| -------------- | -------------------------- |
| `id`           | Event identifier           |
| `message`      | Payload string             |
| `sourceType`   | Where the event originated |
| `sourceEntity` | Entity source (if any)     |
| `sourceBlock`  | Block source (if any)      |
| `initiator`    | NPC initiator (if any)     |

---

## 7. Detecting the Source of an Event

Script Events can be triggered from different places.

### Common Sources

* Player or entity
* Command block
* NPC dialogue
* Server execution

### Example: Source Detection

```js
switch (event.sourceType) {
    case ScriptEventSource.Entity:
        // Triggered by an entity
        break;

    case ScriptEventSource.Block:
        // Triggered by a block
        break;

    case ScriptEventSource.NPCDialogue:
        // Triggered by an NPC
        break;
}
```

---

## 8. Triggering Script Events

### From Chat or Functions

```mcfunction
/scriptevent example:test Hello from chat
```

---

### From Command Blocks

```mcfunction
/scriptevent example:test Triggered by block
```

The script can detect the block location using `sourceBlock`.

---

### From NPC Dialogue

```mcfunction
/scriptevent example:test Triggered by NPC
```

The `initiator` entity becomes available.

---

## 9. Using the Message Payload

The `message` is always a string.

### Plain Text Usage

```mcfunction
/scriptevent example:test Hello world
```

```js
event.message === "Hello world"
```

---

### Structured Data (JSON)

```mcfunction
/scriptevent example:test {"action":"announce","text":"Server restart"}
```

```js
const data = JSON.parse(event.message);
```

This allows Script Events to behave like function calls with parameters.

---

## 10. Step-by-Step Example Flow

1. A command triggers a Script Event
2. The Script API receives it
3. The handler filters by `event.id`
4. The source is validated
5. The message is parsed
6. The action is executed

This flow mirrors how APIs and backend endpoints work.

---

## 11. Script Events as an API Layer

Script Events can be treated as:

* Commands
* Remote procedure calls
* Message queues
* Backend endpoints

This makes them ideal for:

* Admin systems
* NPC logic
* Automation
* Debug tooling

---

## 12. Best Practices

* Always use namespaces
* Keep payloads small
* Validate input
* Handle source types explicitly
* Avoid heavy logic inside listeners
* Treat Script Events as public APIs

---

## 13. Common Mistakes

| Mistake              | Consequence         |
| -------------------- | ------------------- |
| No ID filtering      | Unintended behavior |
| No source validation | Security issues     |
| Parsing invalid JSON | Runtime crashes     |
| Large payloads       | Performance issues  |

---

## 14. Limitations

* Payload is string-only
* No return value
* Execution is one-way
* Not designed for large data transfer

---

## 15. When to Use Script Events

Use Script Events when you need:

* Communication between commands and scripts
* Controlled entry points to logic
* Decoupling between systems
* Lightweight event-based architecture

---

## Final Notes

Script Events are one of the most powerful yet underestimated tools in the Bedrock Script API.
Used correctly, they enable clean, modular, and maintainable systems.
